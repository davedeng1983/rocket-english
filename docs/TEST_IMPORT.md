# 导入功能测试指南

## 快速测试步骤

### 1. 准备测试文件

创建一个 Word 文档（`.docx` 或 `.doc`），格式如下：

```
2024年北京市中考英语真题

1. My friends and I like sports. ____ often play basketball together after school.
A. We
B. I
C. They
D. You

2. Chinese ____ by more people these days.
A. speaks
B. spoke
C. is spoken
D. was spoken

3. I ____ to the park yesterday.
A. go
B. went
C. will go
D. am going
...
```

或者使用项目根目录下的 `test-sample.txt` 作为参考，将其内容复制到 Word 文档中。

### 2. 启动开发服务器

```bash
npm run dev
```

### 3. 访问导入页面

1. 打开浏览器，访问 `http://localhost:3000`
2. 登录或注册账号
3. 点击"📥 导入试卷"按钮，或直接访问 `http://localhost:3000/import`

### 4. 上传文件

1. 点击"选择 Word 文档"
2. 选择准备好的测试文件
3. 点击"开始导入"

### 5. 验证结果

导入成功后，应该看到：
- ✅ 导入成功提示
- 试卷标题
- 题目数量（应该是 10 道）
- 知识点关联数量

### 6. 验证数据库

1. 访问 Supabase Dashboard
2. 进入 Table Editor
3. 检查以下表：
   - `exam_papers` - 应该有新导入的试卷
   - `questions` - 应该有 10 道题目
   - `content_knowledge_edges` - 应该有知识点关联

### 7. 测试使用

1. 访问 `/study` 页面
2. 应该能看到新导入的试卷
3. 选择试卷开始测试

## 测试用例

### 用例 1：标准格式文档
- **输入**：标准格式的 Word 文档（题号. 题干 A. 选项...）
- **预期**：成功导入，识别所有题目

### 用例 2：非标准格式
- **输入**：格式不规范的文档
- **预期**：可能无法识别题目，返回错误提示

### 用例 3：空文档
- **输入**：空白 Word 文档
- **预期**：返回"未能提取到题目"错误

### 用例 4：大文件
- **输入**：包含大量题目的文档（100+ 题）
- **预期**：成功导入，但可能需要较长时间

## 常见问题排查

### 问题 1：导入失败，提示"文档解析失败"
- **原因**：文件格式不正确或文件损坏
- **解决**：检查文件是否为有效的 Word 文档

### 问题 2：题目数量为 0
- **原因**：文档格式不匹配正则表达式
- **解决**：检查文档格式是否符合要求（题号. 题干 A. 选项...）

### 问题 3：知识点识别不准确
- **原因**：关键词匹配规则有限
- **解决**：这是正常的，可以在数据库中手动调整

### 问题 4：上传按钮无响应
- **原因**：可能未登录
- **解决**：先登录账号

## 调试技巧

### 1. 查看控制台日志

打开浏览器开发者工具（F12），查看 Console 标签页，可以看到详细的错误信息。

### 2. 查看网络请求

在 Network 标签页中，查看 `/api/import-paper` 请求的响应，可以看到详细的错误信息。

### 3. 检查服务器日志

在终端中查看 `npm run dev` 的输出，可以看到服务器端的错误信息。

## 测试检查清单

- [ ] 可以访问导入页面
- [ ] 可以选择文件
- [ ] 可以上传文件
- [ ] 导入成功提示显示
- [ ] 题目数量正确
- [ ] 知识点关联创建成功
- [ ] 试卷出现在 `/study` 页面
- [ ] 可以选择试卷开始测试

