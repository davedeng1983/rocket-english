# 导入功能测试指南

## 🚀 快速开始

### 1. 启动开发服务器

```bash
cd /Users/haixinggongshe/rocketenglish-app
npm run dev
```

服务器会在 `http://localhost:3000` 启动。

### 2. 准备测试文件

我已经在项目根目录创建了 `test-sample.txt` 文件，包含 10 道测试题目。

**步骤：**
1. 打开 `test-sample.txt`
2. 复制全部内容
3. 打开 Microsoft Word 或 Google Docs
4. 粘贴内容
5. 保存为 `.docx` 格式（如 `test-paper.docx`）

### 3. 测试导入功能

#### 步骤 A：登录系统
1. 访问 `http://localhost:3000`
2. 点击"登录"按钮
3. 如果没有账号，先注册

#### 步骤 B：访问导入页面
1. 点击首页的"📥 导入试卷"按钮
2. 或直接访问 `http://localhost:3000/import`

#### 步骤 C：上传文件
1. 点击"选择 Word 文档"
2. 选择刚才保存的 `test-paper.docx` 文件
3. 点击"开始导入"按钮

#### 步骤 D：验证结果
导入成功后，应该看到：
- ✅ 绿色成功提示框
- 试卷标题：`2024年北京市中考英语真题`（或文件名）
- 题目数量：`10`
- 知识点关联数量：应该 > 0

#### 步骤 E：验证数据库
1. 访问 Supabase Dashboard
2. 进入 **Table Editor**
3. 检查以下表：
   - `exam_papers` - 应该有新记录
   - `questions` - 应该有 10 条记录
   - `content_knowledge_edges` - 应该有知识点关联

#### 步骤 F：测试使用
1. 访问 `http://localhost:3000/study`
2. 应该能看到新导入的试卷
3. 点击试卷开始测试

## 📋 测试检查清单

- [ ] 开发服务器正常启动
- [ ] 可以访问导入页面
- [ ] 可以选择 Word 文件
- [ ] 文件上传成功
- [ ] 导入成功提示显示
- [ ] 题目数量正确（10 道）
- [ ] 知识点关联创建成功
- [ ] 试卷出现在 `/study` 页面
- [ ] 可以选择试卷开始测试

## 🐛 常见问题排查

### 问题 1：导入失败，提示"文档解析失败"
**可能原因：**
- 文件格式不正确
- 文件损坏
- 文档格式不符合要求

**解决方法：**
1. 检查文件是否为 `.docx` 或 `.doc` 格式
2. 检查文档格式是否符合要求（题号. 题干 A. 选项...）
3. 参考 `test-sample.txt` 的格式

### 问题 2：题目数量为 0
**可能原因：**
- 文档格式不匹配正则表达式
- 题目格式不正确

**解决方法：**
1. 确保题目格式为：`1. 题干 A. 选项A B. 选项B C. 选项C D. 选项D`
2. 选项必须用 `A.`、`B.`、`C.`、`D.` 开头
3. 每个选项占一行

### 问题 3：上传按钮无响应
**可能原因：**
- 未登录
- JavaScript 错误

**解决方法：**
1. 检查是否已登录
2. 打开浏览器开发者工具（F12）查看 Console 错误
3. 检查 Network 标签页中的请求状态

### 问题 4：知识点识别不准确
**可能原因：**
- 关键词匹配规则有限
- 题目内容不包含匹配的关键词

**解决方法：**
- 这是正常的，当前使用关键词匹配，准确率约 70-90%
- 可以在数据库中手动调整 `content_knowledge_edges` 表

## 🔍 调试技巧

### 1. 查看浏览器控制台
- 按 F12 打开开发者工具
- 查看 Console 标签页的错误信息
- 查看 Network 标签页的请求响应

### 2. 查看服务器日志
- 在运行 `npm run dev` 的终端中查看输出
- 查找错误堆栈信息

### 3. 检查 API 响应
在浏览器 Network 标签页中：
1. 找到 `/api/import-paper` 请求
2. 查看 Response 内容
3. 如果有错误，查看 `error` 字段

## 📝 测试用例

### 用例 1：标准格式文档 ✅
- **输入**：标准格式的 Word 文档（10 道题）
- **预期**：成功导入，识别 10 道题目

### 用例 2：非标准格式 ❌
- **输入**：格式不规范的文档
- **预期**：可能无法识别题目，返回错误提示

### 用例 3：空文档 ❌
- **输入**：空白 Word 文档
- **预期**：返回"未能提取到题目"错误

### 用例 4：大文件 ⚠️
- **输入**：包含大量题目的文档（100+ 题）
- **预期**：成功导入，但可能需要较长时间

## 🎯 预期结果

导入成功后，系统应该：
1. ✅ 创建试卷记录（`exam_papers` 表）
2. ✅ 创建 10 道题目记录（`questions` 表）
3. ✅ 自动识别知识点并创建关联（`content_knowledge_edges` 表）
4. ✅ 试卷出现在 `/study` 页面
5. ✅ 可以选择试卷开始测试

## 📞 需要帮助？

如果遇到问题：
1. 检查浏览器控制台的错误信息
2. 检查服务器日志
3. 查看 `docs/IMPORT_GUIDE.md` 获取详细说明
4. 确认 Supabase 数据库连接正常

